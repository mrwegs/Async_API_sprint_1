# Проектная работа 4 спринта

Ссылка на репозиторий:\
https://github.com/lysenkigor/Async_API_sprint_1

## Доработка ETL

В данном спринте для добвления новых индексов был доработан etl сервис из предыдушего
спринт. Для удобства сервис находится в одной директории с текущим сервисом.
Т.к. подразумевается что это отдельный сервис, в директории /etl находится .env файл
данные для подключения в котором должны совпадать с основным .env файлом.
___
## Запуск проекта

В директории проекта по примеру `.env.example` подготовить `.env`.
В директории /etl сделать аналогично.

> ***Внимание: данные для подключения к redis, postgres, elasticsearch в файлах
> .env и /etl/.env должны быть одинаковые!***

Для запуска проекта из корневой директории выполнить команду:
```
docker-compose up --build
```

---

## Запуск тестов

Для запуска тестов необходимо в директории `/test/functional` подготовить `.env`, в качестве примера использовать `.env.example`

Запустить тесты можно одним из вариантов:

1. Запуск тестов в docker контейнере \
 \
   Для запуска тестов из директории `tests/functional` выполнить команду: 
   ```
    docker-compose up --build
   ```
2. Запуск тестов локально \
\
 Для запуска необходимо в .env указать настройки elasticsearch, redis запущенных локально. \
 Выполнить команду для запуска тестов
    ```
    pytest
    ```

---

## Общее описание endpoints
Асинхронный API для кинотеатра. 
1) **/api/v1/films** - выводятся популярные фильмы
2) **/api/v1/films?genre=\<name:str>** - популярные фильмы определенного жанра
3) **/api/v1/genres/** - все жанры
4) **/api/v1/films/search?title=\<name:str>** - поиск по фильмам
5) **/api/v1/persons/search?name=<full_name:str>** - поиск по персонам
6) **/api/v1/films/\<uuid:UUID>/** - полная информация по фильму
7) **/api/v1/persons/\<uuid:UUID>/**  - данные по персоне
8) **/api/v1/persons/\<uuid:UUID>/film/** - фильмы по персоне
9) **/api/v1/genres/\<uuid:UUID>/** -  данные по конкретному жанру.
